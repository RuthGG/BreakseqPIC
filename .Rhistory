# Example
args[1]<-"v2.3.3.300"  # Library version
# LOAD ARGUMENTS
# =========================================================================== #
args = commandArgs(trailingOnly=TRUE)
# Example
args[1]<-"v2.3.3.300"  # Library version
setwd("~/Documents/PHD_Repos/20210325_breakseqPIC")
samfile_original<-read.table("tmp/coordCheck/result", comment.char = "@", sep = "\t",fill = T, stringsAsFactors = F)
samfile_original<-read.table("data/raw/seed_librerias/v2.3.3.300/coordCheck/result", comment.char = "@", sep = "\t",fill = T, stringsAsFactors = F)
View(samfile_original)
samfile<-samfile_original[,c(1,3,4,6)]
colnames(samfile)<-c("Probe", "Chromosome", "Coordinate", "CIGAR")
View(samfile)
coords<-read.table(paste0("data/raw/seed_librerias/",args[1],"/bplib.coords"), stringsAsFactors = F)
colnames(coords)<-c("Probe", "Chromosome", "Start", "End", "Length")
View(coords)
unique(coords$Probe)
duplicated(coords$Probe)
coords$Probe[duplicated(coords$Probe),]
coords$Probe[duplicated(coords$Probe)]
# Merge
check<-merge(coords, samfile, all.x = T, by = "Probe", suffixes = c("Coords", "Bowtie"))
View(check)
View(check)
check$Result<- ifelse(( check$ChromosomeCoords == check$ChromosomeBowtie & check$Start == check$Coordinate & check$CIGAR == "300M"), "Good", NA )
notREF<-samfile[ !(samfile$Probe %in% coords$Probe), ]
View(notREF)
notREF<-notREF[!(notREF$CIGAR %in% c("*", "", " ", NA)),]
View(notREF)
colnames(notREF)[5]<-"MAPQ"
notREF<-merge(notREF, samfile_original[,c(1,5)], by.x = "Probe", by.y = "V1", all.x = TRUE)
colnames(notREF)[5]<-"MAPQ"
View(samfile_original)
View(notREF)
notREF<-samfile[ !(samfile$Probe %in% coords$Probe), ]
notREF<-notREF[!(notREF$CIGAR %in% c("*", "", " ", NA)),]
View(notREF)
View(samfile_original)
notREF<-merge(notREF, samfile_original[,c(1,5)], by.x = "Probe", by.y = "V1", all.x = TRUE)
colnames(notREF)[5]<-"MAPQ"
View(notREF)
notREF<-samfile[ !(samfile$Probe %in% coords$Probe), ]
notREF<-notREF[!(notREF$CIGAR %in% c("*", "", " ", NA)),]
notREF
samfile_original[,c(1,5)]
notREF<-merge(notREF, samfile_original[,c(1,5)], by.x = "Probe", by.y = "V1", all.x = TRUE)
View(notREF)
notREF<-samfile[ !(samfile$Probe %in% coords$Probe), ]
notREF<-notREF[!(notREF$CIGAR %in% c("*", "", " ", NA)),]
notREF
samfile_original[,c(1,5)]
notREF<-merge(notREF, samfile_original[,c(1,5)], by.x = "Probe", by.y = "V1", all.x = TRUE)
colnames(notREF)[5]<-"MAPQ"
View(check)
duplicated(check$Probe)
sum(duplicated(check$Probe))
duplicated(samfile$Probe)
samfile[duplicated(samfile$Probe),]
repeated<-samfile[!unique(samfile$Probe)]
unique(samfile$Probe)
repeated<-samfile[!(samfile$Probe %in% unique(samfile$Probe),]
repeated<-samfile[!(samfile$Probe %in% unique(samfile$Probe)),]
View(repeated)
samfile$Probe
unique(samfile$Probe)
samfile$Probe %in% unique(samfile$Probe)
duplicated(samfile$Probe)
samfile$Probe[duplicated(samfile$Probe)]
repeated<-samfile[samfile$Probe %in% samfile$Probe[duplicated(samfile$Probe)],]
View(repeated)
View(samfile)
View(repeated)
View(coords)
duplicate(coords$Probe)
duplicated(coords$Probe)
wum(duplicated(coords$Probe))
sum(duplicated(coords$Probe))
fasta<-read.file("data/raw/seed_librerias/v2.3.3.300/bplib.fa")
fasta<-read.table("data/raw/seed_librerias/v2.3.3.300/bplib.fa")
duplicated(fasta$V1)
fasta[duplicated(fasta$V1),]
samfile_original<-read.table("data/raw/seed_librerias/v2.3.3.300/coordCheck/result", comment.char = "@", sep = "\t",fill = T, stringsAsFactors = F)
samfile<-samfile_original[,c(1,3,4,6)]
colnames(samfile)<-c("Probe", "Chromosome", "Coordinate", "CIGAR")
repeated<-samfile[samfile$Probe %in% samfile$Probe[duplicated(samfile$Probe)],]
View(repeated)
coords<-read.table(paste0("data/raw/seed_librerias/",args[1],"/bplib.coords"), stringsAsFactors = F)
colnames(coords)<-c("Probe", "Chromosome", "Start", "End", "Length")
# Merge
check<-merge(coords, samfile, all.x = T, by = "Probe", suffixes = c("Coords", "Bowtie"))
check$Result<- ifelse(( check$ChromosomeCoords == check$ChromosomeBowtie & check$Start == check$Coordinate & check$CIGAR == "300M"), "Good", NA )
View(check)
notREF<-samfile[ !(samfile$Probe %in% coords$Probe), ]
notREF<-notREF[!(notREF$CIGAR %in% c("*", "", " ", NA)),]
notREF<-merge(notREF, samfile_original[,c(1,5)], by.x = "Probe", by.y = "V1", all.x = TRUE)
colnames(notREF)[5]<-"MAPQ"
View(notREF)
write.table(check, "tmp/coordCheck/REF")
write.table(notREF, "tmp/coordCheck/notREF")
write.table(check, "data/raw/seed_librerias/v2.3.3.300/coordCheck/REF")
write.table(notREF, "data/raw/seed_librerias/v2.3.3.300/coordCheck/notREF")
